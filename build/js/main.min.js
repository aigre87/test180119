function init(){container=document.getElementById("canvasWrapper"),document.body.appendChild(container),container&&(container.className+=container.className?" waves":"waves"),projector=new THREE.Projector,raycaster=new THREE.Raycaster;new THREE.Vector3;camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,1e4),camera.position.x=-1001,camera.position.y=100,camera.position.z=1386,camera.lookAt(new THREE.Vector3(0,0,0)),scene=new THREE.Scene;var e=new THREE.AxesHelper(200);scene.add(e);for(var n=(new THREE.GridHelper(600,60),Math.PI,new Float32Array(AMOUNTX*AMOUNTY*3)),r=new Float32Array(AMOUNTX*AMOUNTY),t=0,a=0,o=0;o<AMOUNTX;o++)for(var i=0;i<AMOUNTY;i++)n[t]=o*SEPARATION-(AMOUNTX*SEPARATION/2-SEPARATION/2),n[t+1]=300*Math.sin((o/40*-210-i/40*90)*Math.PI/180),n[t+2]=i*SEPARATION-(AMOUNTY*SEPARATION/2-SEPARATION/2),r[a]=20,t+=3,a++;var c=new THREE.BufferGeometry;c.addAttribute("position",new THREE.BufferAttribute(n,3)),c.addAttribute("scale",new THREE.BufferAttribute(r,1));var s=new THREE.ShaderMaterial({uniforms:{color:{value:new THREE.Color(22015)}},vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent});particles=new THREE.Points(c,s),scene.add(particles),renderer=new THREE.WebGLRenderer({alpha:!0}),renderer.setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement),window.addEventListener("resize",onWindowResize,!1),window.addEventListener("click",clickOnSprite,!1)}function clickOnSprite(e){console.log("CLICK! "+e.clientX+", "+e.clientY),mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1,raycaster.setFromCamera(mouse,camera);var n=raycaster.intersectObject(particles);n.length>0&&(console.log(n),n[0].object.material.uniforms.color.value.setHex(16711680))}function onclick(e){var n=new THREE.Vector2;raycaster.setFromCamera(n,camera);var r=raycaster.intersectObjects(particles,!0);r.length>0&&(selectedObject=r[0],console.log(r),selectedObject.object.material.color.setHex("0xffffff"))}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function animate(){requestAnimationFrame(animate),render()}function changeColor(){var e=new ScrollMagic.Controller,n=new THREE.Color(16711680),r=TweenMax.to(particles.material.uniforms.color.value,2,{r:n.r,g:n.g,b:n.b});new ScrollMagic.Scene({triggerElement:"body",triggerHook:0,duration:1e3,offset:0}).setTween(r).addTo(e)}function changePos(){for(var e=particles.geometry.attributes.position.array,n=0,r=0,t=0;t<AMOUNTX;t++)for(var a=0;a<AMOUNTY;a++)!function(n){console.log(n);var r=e[n+1],o=parseFloat(r),i={val:o+1e3},c=o;TweenMax.to(i,4-.05*t+.05*a,{val:c,roundProps:"val",onUpdate:function(){e[n+1]=i.val}})}(n),n+=3,r++}function render(){for(var e=particles.geometry.attributes.scale.array,n=0,r=0,t=0;t<AMOUNTX;t++)for(var a=0;a<AMOUNTY;a++)e[r]=5*(Math.sin(0*(t-count))+2)+15*(Math.sin(.1*(a-count))+1),n+=3,r++;particles.geometry.attributes.position.needsUpdate=!0,particles.geometry.attributes.scale.needsUpdate=!0,particles.material.uniforms.color.needsUpdate=!0,renderer.render(scene,camera),count+=.15,count2<=0?count2=0:count2-=4}var SEPARATION=30,AMOUNTX=40,AMOUNTY=40,camera;window.camera="123";var container,scene,renderer,projector,raycaster,mouse=new THREE.Vector2,INTERSECTED,particles,count=0,count2=400,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;init(),animate(),changeColor(),changePos();