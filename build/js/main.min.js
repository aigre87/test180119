function init(){container=document.getElementById("canvasWrapper"),document.body.appendChild(container),container&&(container.className+=container.className?" waves":"waves"),projector=new THREE.Projector,raycaster=new THREE.Raycaster;new THREE.Vector3;camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,1e4),camera.position.x=-501,camera.position.y=508,camera.position.z=-526,camera.lookAt(new THREE.Vector3(0,0,0)),scene=new THREE.Scene;var e=new THREE.AxesHelper(200);scene.add(e);new THREE.GridHelper(600,60),new THREE.OrbitControls(camera,container);particles=new Array;for(var n=2*Math.PI,i=new THREE.SpriteMaterial({sizeAttenuation:!0,color:22015,program:function(e){e.beginPath(),e.arc(0,0,.2,0,n,!0),e.fill()}}),t=0,r=0;r<AMOUNTX;r++)for(var o=0;o<AMOUNTY;o++)particle=particles[t++]=new THREE.Sprite(i),particle.position.x=r*SEPARATION-(AMOUNTX*SEPARATION/2-SEPARATION/2),particle.position.z=o*SEPARATION-(AMOUNTY*SEPARATION/2-SEPARATION/2),scene.add(particle);renderer=new THREE.WebGLRenderer({alpha:!0}),renderer.setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement),window.addEventListener("resize",onWindowResize,!1)}function clickOnSprite(e){console.log("CLICK! "+e.clientX+", "+e.clientY),mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1,raycaster.setFromCamera(mouse,camera),raycaster.intersectObjects(particles).forEach(function(e){console.log("Intersection: "+e.object)})}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function animate(){requestAnimationFrame(animate),render()}function render(){for(var e=0,n=0;n<AMOUNTX;n++)for(var i=0;i<AMOUNTY;i++)particle=particles[e++],particle.position.y=20*Math.sin(0*(n+count))+10*Math.sin(.5*(i+count))+50,particle.scale.x=particle.scale.y=4*(Math.sin(0*(n+count))+2)+4*(Math.sin(.5*(i+count))+1);renderer.render(scene,camera),count+=.1}function tt(){function e(){c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),w.setSize(window.innerWidth,window.innerHeight)}function n(e,n,i){n||(n=16),i||(i=l);var t=new THREE.Sprite(i);t.position=e,t.scale.x=t.scale.y=n,s.add(t)}function i(e,n,i){return i/n*e}function t(e,t,r){for(var o=0;o<50;o++){var a=i(t.x-e.x,50,o),c=i(t.y-e.y,50,o),s=i(t.z-e.z,50,o);n(new THREE.Vector3(e.x+a,e.y+c,e.z+s),Math.max(1,window.innerWidth/500),r)}}function r(e){if(0===e.button){e.preventDefault();var i=document.getElementById("zInput"),r=parseFloat(i.value);if(!isNaN(r)){c.position.set(0,0,H),o();var a=new THREE.Vector3(e.clientX/h*2-1,-e.clientY/m*2+1,r);d.unprojectVector(a,c),t(c.position,a,p),a.sub(c.position),a.normalize();var s=new THREE.Raycaster(c.position,a),w=2*window.innerWidth,T=new THREE.Vector3(s.ray.direction.x*w,s.ray.direction.y*w,s.ray.direction.z*w),R=new THREE.Vector3(c.position.x+T.x,c.position.y+T.y,c.position.z+T.z);t(c.position,R,l);var f=s.intersectObjects(u);f.length>0&&f[0].object.material.color.setHex(16777215*Math.random());var v=new THREE.Vector3(c.position.x,c.position.y,c.position.z);c.position.set(c.position.x+10,c.position.y+10,c.position.z+20),n(v,4,E),o()}}}function o(){w.render(s,c)}var a,c,s,d,w,l,p,E,h=window.innerWidth,m=window.innerHeight,H=window.innerWidth,u=[];!function(){a=document.createElement("div"),document.body.appendChild(a),c=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e4),c.position.set(0,0,H),s=new THREE.Scene;var n=new THREE.BoxGeometry(100,100,100),i=new THREE.Mesh(n,new THREE.MeshBasicMaterial({color:255,opacity:.5}));i.position.x=0,i.position.y=0,i.position.z=0,i.scale.x=1,i.scale.y=1,i.scale.z=1,i.rotation.x=Math.PI/4,i.rotation.y=Math.PI/4,i.rotation.z=Math.PI/4,s.add(i),u.push(i);var t=2*Math.PI;l=new THREE.SpriteCanvasMaterial({color:0,program:function(e){e.beginPath(),e.arc(0,0,.5,0,t,!0),e.fill()}}),p=new THREE.SpriteCanvasMaterial({color:65280,program:function(e){e.beginPath(),e.arc(0,0,.5,0,t,!0),e.fill()}}),E=new THREE.SpriteCanvasMaterial({color:255,program:function(e){e.beginPath(),e.arc(0,0,.5,0,t,!0),e.fill()}}),d=new THREE.Projector,w=new THREE.CanvasRenderer,w.setClearColor(15790320),w.setSize(h,m),a.appendChild(w.domElement),w.domElement.addEventListener("mousedown",r,!1),window.addEventListener("resize",e,!1),c.lookAt(new THREE.Vector3(0,0,0)),o()}(),animate()}var SEPARATION=30,AMOUNTX=20,AMOUNTY=20,container,camera,scene,renderer,projector,particles,particle,count=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;init(),animate();